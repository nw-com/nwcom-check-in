<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>西北勤務打卡系統</title>
    <link rel="icon" type="image/png" href="https://static.wixstatic.com/media/6148f9_56377cef73c1498f95a2c3057b89f2ed~mv2.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="bg-red-600 flex justify-center items-center min-h-screen">

    <div id="root-container" class="w-[calc(100%-20px)] max-w-[400px] h-[calc(100vh-80px)] max-h-[750px] bg-white rounded-2xl shadow-lg overflow-hidden flex flex-col transition-all duration-300 ease-in-out mx-auto">
        
        <!-- 登入畫面 -->
        <div id="login-view" class="flex-1 overflow-y-auto flex flex-col min-h-[480px]">
            <!-- Login content will be loaded here -->
        </div>

        <!-- 主操作畫面 -->
        <div id="main-view" class="hidden flex-1 flex flex-col relative">
            <!-- Header -->
            <header class="absolute top-0 left-0 w-full z-20 bg-red-600 text-white p-3 flex justify-between items-center shadow-md h-[70px]">
                <div class="flex items-center space-x-4">
                    <img src="https://static.wixstatic.com/media/6148f9_56377cef73c1498f95a2c3057b89f2ed~mv2.png" alt="西北保全 Logo" style="width: 80px; height: 40px; object-fit: contain;">
                    <div>
                        <h1 class="text-lg font-bold">西北勤務打卡系統</h1>
                        <p id="user-name-display" class="text-sm opacity-90"></p>
                    </div>
                </div>
                <button id="profile-btn" class="rounded-full h-12 w-12 bg-gray-200 overflow-hidden flex-shrink-0 border-2 border-white">
                    <img id="header-profile-img" src="https://placehold.co/96x96/e2e8f0/4a5568?text=頭像" class="h-full w-full object-cover">
                </button>
            </header>

            <!-- 中間內容區 (包含子導覽與可滾動內容) -->
            <div class="flex-1 flex flex-col overflow-hidden">
                <!-- Date Time Display / Sub Nav Container -->
                <div class="h-[50px] border-b border-gray-200 bg-gray-100 flex-shrink-0">
                    <div id="datetime-display" class="h-full px-6 bg-white flex items-center justify-center text-xl font-semibold text-gray-800">
                        <!-- Date and time will be injected here by JavaScript -->
                    </div>
                    <!-- 子導覽列 -->
                    <div id="sub-tab-nav" class="h-full px-6">
                        <!-- 設定頁面專用 -->
                        <nav id="settings-tab-nav" class="hidden -mb-px flex space-x-6 h-full items-center" aria-label="Tabs">
                            <button id="settings-account-tab-btn" class="whitespace-nowrap h-full flex items-center px-1 border-b-2 font-medium text-sm">帳號</button>
                            <button id="settings-rules-tab-btn" class="whitespace-nowrap h-full flex items-center px-1 border-b-2 font-medium text-sm">規則</button>
                        </nav>
                        <!-- 打卡頁面專用 -->
                        <nav id="checkin-tab-nav" class="hidden -mb-px flex space-x-6 h-full items-center" aria-label="Tabs">
                            <button id="checkin-location-tab-btn" class="whitespace-nowrap h-full flex items-center px-1 border-b-2 font-medium text-sm">定位打卡</button>
                            <button id="checkin-history-tab-btn" class="whitespace-nowrap h-full flex items-center px-1 border-b-2 font-medium text-sm">打卡紀錄</button>
                        </nav>
                    </div>
                </div>
                
                <!-- 可滾動的頁面內容 -->
                <main class="flex-1 overflow-y-auto p-6 bg-gray-100 h-[calc(100%-50px)]">
                    <div id="message-box" class="hidden p-4 mb-4 text-sm rounded-lg" role="alert">
                        <span class="font-medium" id="message-content"></span>
                    </div>

                    <!-- 儀表板頁面 -->
                    <div id="dashboard-page" class="hidden">
                        <!-- Dashboard content will be loaded here -->
                    </div>

                    <!-- 打卡頁面 -->
                    <div id="checkin-page" class="hidden">
                        <!-- Checkin content will be loaded here -->
                    </div>

                    <!-- 設定頁面 -->
                    <div id="settings-page" class="hidden h-full">
                        <!-- Settings content will be loaded here -->
                    </div>
                </main>
            </div>

            <!-- 底部導覽列 -->
            <nav id="bottom-nav" class="absolute bottom-0 left-0 w-full z-20 border-t bg-gray-50 h-[70px] flex items-center">
                <div class="flex justify-around w-full">
                    <button id="nav-dashboard-btn" class="flex-1 p-3 text-center text-gray-500 flex flex-col items-center justify-center space-y-1 transition-colors duration-200">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
                        <span class="text-xs">儀表板</span>
                    </button>
                    <button id="nav-checkin-btn" class="flex-1 p-3 text-center text-gray-500 flex flex-col items-center justify-center space-y-1 transition-colors duration-200">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" x2="3" y1="12" y2="12"/></svg>
                        <span class="text-xs">打卡</span>
                    </button>
                    <button id="nav-settings-btn" class="hidden flex-1 p-3 text-center text-gray-500 flex flex-col items-center justify-center space-y-1 transition-colors duration-200">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
                        <span class="text-xs">設定</span>
                    </button>
                </div>
            </nav>
        </div>
    </div>

    <!-- Modals container -->
    <div id="modals-container">
        <!-- Modal content will be loaded here -->
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";
        import { getFirestore, collection, doc, setDoc, getDoc, getDocs, query, where, orderBy, onSnapshot, serverTimestamp, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-storage.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD_iFPyT_oNbz1LEQGPg7X8Z_nzGf8bKGQ",
            authDomain: "nwcom-check-in.firebaseapp.com",
            projectId: "nwcom-check-in",
            storageBucket: "nwcom-check-in.appspot.com",
            messagingSenderId: "1086299051686",
            appId: "1:1086299051686:web:8b4e625ed4a5b0e1e4b0a6"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        // Make Firebase services available globally
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseStorage = storage;
        window.firebaseServices = {
            signInWithEmailAndPassword,
            onAuthStateChanged,
            signOut,
            collection,
            doc,
            setDoc,
            getDoc,
            getDocs,
            query,
            where,
            orderBy,
            onSnapshot,
            serverTimestamp,
            deleteDoc,
            updateDoc,
            ref,
            uploadBytes,
            getDownloadURL
        };
    </script>

    <!-- Load page content and initialize app -->
    <script type="module" src="js/app.js"></script>
</body>
</html>